"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/implementations/pure-multicall";
exports.ids = ["pages/api/implementations/pure-multicall"];
exports.modules = {

/***/ "ethers":
/*!*************************!*\
  !*** external "ethers" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("ethers");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "axios":
/*!************************!*\
  !*** external "axios" ***!
  \************************/
/***/ ((module) => {

module.exports = import("axios");;

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fimplementations%2Fpure-multicall&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fimplementations%2Fpure-multicall.js&middlewareConfigBase64=e30%3D!":
/*!**********************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fimplementations%2Fpure-multicall&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fimplementations%2Fpure-multicall.js&middlewareConfigBase64=e30%3D! ***!
  \**********************************************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_implementations_pure_multicall_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/implementations/pure-multicall.js */ \"(api)/./pages/api/implementations/pure-multicall.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_implementations_pure_multicall_js__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_implementations_pure_multicall_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_implementations_pure_multicall_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_implementations_pure_multicall_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/implementations/pure-multicall\",\n        pathname: \"/api/implementations/pure-multicall\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_implementations_pure_multicall_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmltcGxlbWVudGF0aW9ucyUyRnB1cmUtbXVsdGljYWxsJnByZWZlcnJlZFJlZ2lvbj0mYWJzb2x1dGVQYWdlUGF0aD0uJTJGcGFnZXMlMkZhcGklMkZpbXBsZW1lbnRhdGlvbnMlMkZwdXJlLW11bHRpY2FsbC5qcyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUMwRTtBQUMxRTtBQUNBLGlFQUFlLHdFQUFLLENBQUMseUVBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLHlFQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCxxQyIsInNvdXJjZXMiOlsid2VicGFjazovL2JheWMtZXRoLXN1bS8/OTFkYiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXMvYXBpL2ltcGxlbWVudGF0aW9ucy9wdXJlLW11bHRpY2FsbC5qc1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2ltcGxlbWVudGF0aW9ucy9wdXJlLW11bHRpY2FsbFwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2ltcGxlbWVudGF0aW9ucy9wdXJlLW11bHRpY2FsbFwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fimplementations%2Fpure-multicall&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fimplementations%2Fpure-multicall.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/implementations/pure-multicall.js":
/*!*****************************************************!*\
  !*** ./pages/api/implementations/pure-multicall.js ***!
  \*****************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var ethers__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ethers */ \"ethers\");\n/* harmony import */ var ethers__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(ethers__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! axios */ \"axios\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! path */ \"path\");\n/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(path__WEBPACK_IMPORTED_MODULE_3__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([axios__WEBPACK_IMPORTED_MODULE_1__]);\naxios__WEBPACK_IMPORTED_MODULE_1__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n// Pure-Multicall implementation - uses multicall for ALL RPC queries\n\n\n\n\n// Constants\nconst BAYC_CONTRACT_ADDRESS = \"0xBC4CA0EdA7647A8aB7C2061c2E118A18a936f13D\";\nconst ETHERSCAN_API_URL = \"https://api.etherscan.io/api\";\nconst ETHERSCAN_API_KEY = process.env.ETHERSCAN_API_KEY || \"\";\nconst ALCHEMY_API_KEY = process.env.ALCHEMY_API_KEY || \"\";\nconst ALCHEMY_API_URL = `https://eth-mainnet.g.alchemy.com/v2/${ALCHEMY_API_KEY}`;\n// Multicall Contract Addresses\nconst MULTICALL_ADDRESS = \"0xcA11bde05977b3631167028862bE2a173976CA11\"; // Multicall3 contract\n// ABI for Multicall3\nconst MULTICALL_ABI = [\n    \"function aggregate(tuple(address target, bytes callData)[] calls) view returns (uint256 blockNumber, bytes[] returnData)\",\n    \"function aggregate3(tuple(address target, bool allowFailure, bytes callData)[] calls) view returns (tuple(bool success, bytes returnData)[] returnData)\",\n    \"function getEthBalance(address addr) view returns (uint256 balance)\"\n];\n// ABI for ERC721 (BAYC)\nconst BAYC_ABI = [\n    \"function totalSupply() view returns (uint256)\",\n    \"function ownerOf(uint256 tokenId) view returns (address)\"\n];\n// Results file path\nconst RESULTS_FILE_PATH = path__WEBPACK_IMPORTED_MODULE_3___default().join(process.cwd(), \"data\", \"results.json\");\n// Provider and contract initialization\nlet provider = null;\nlet multicallContract = null;\n/**\n * Initialize provider\n */ const initProvider = ()=>{\n    if (provider) return provider;\n    console.log(\"Initializing provider...\");\n    if (ALCHEMY_API_KEY) {\n        try {\n            console.log(\"Using Alchemy provider\");\n            provider = new ethers__WEBPACK_IMPORTED_MODULE_0__.ethers.providers.JsonRpcProvider(ALCHEMY_API_URL);\n            return provider;\n        } catch (error) {\n            console.error(\"Failed to create provider:\", error.message);\n            provider = null;\n        }\n    } else {\n        console.error(\"No Alchemy API key provided!\");\n    }\n    throw new Error(\"Failed to initialize provider\");\n};\n/**\n * Initialize Multicall contract\n */ const initMulticall = ()=>{\n    if (multicallContract) return multicallContract;\n    const p = provider || initProvider();\n    try {\n        multicallContract = new ethers__WEBPACK_IMPORTED_MODULE_0__.ethers.Contract(MULTICALL_ADDRESS, MULTICALL_ABI, p);\n        console.log(\"Multicall contract initialized\");\n        return multicallContract;\n    } catch (error) {\n        console.error(\"Failed to initialize multicall contract:\", error.message);\n        return null;\n    }\n};\n/**\n * Save results to file for persistence\n */ async function saveResultsToFile(implementationId, timestamp, result) {\n    try {\n        // Create directory if it doesn't exist\n        const dir = path__WEBPACK_IMPORTED_MODULE_3___default().dirname(RESULTS_FILE_PATH);\n        if (!fs__WEBPACK_IMPORTED_MODULE_2___default().existsSync(dir)) {\n            fs__WEBPACK_IMPORTED_MODULE_2___default().mkdirSync(dir, {\n                recursive: true\n            });\n        }\n        // Read existing results or create new object\n        let results = {};\n        if (fs__WEBPACK_IMPORTED_MODULE_2___default().existsSync(RESULTS_FILE_PATH)) {\n            const fileContent = fs__WEBPACK_IMPORTED_MODULE_2___default().readFileSync(RESULTS_FILE_PATH, \"utf8\");\n            results = JSON.parse(fileContent);\n        }\n        // Add new result\n        if (!results[implementationId]) {\n            results[implementationId] = {};\n        }\n        // Convert BigNumber to string for JSON storage\n        const resultToSave = {\n            ...result,\n            totalWei: result.totalWei?.toString(),\n            executionTime: result.executionTime,\n            timestamp: new Date().toISOString()\n        };\n        results[implementationId][timestamp] = resultToSave;\n        // Write back to file\n        fs__WEBPACK_IMPORTED_MODULE_2___default().writeFileSync(RESULTS_FILE_PATH, JSON.stringify(results, null, 2));\n        console.log(`Results saved to ${RESULTS_FILE_PATH}`);\n    } catch (error) {\n        console.error(\"Error saving results to file:\", error);\n    }\n}\n/**\n * Get previous results from cache file\n */ function getPreviousResults() {\n    try {\n        if (fs__WEBPACK_IMPORTED_MODULE_2___default().existsSync(RESULTS_FILE_PATH)) {\n            const fileContent = fs__WEBPACK_IMPORTED_MODULE_2___default().readFileSync(RESULTS_FILE_PATH, \"utf8\");\n            return JSON.parse(fileContent);\n        }\n    } catch (error) {\n        console.error(\"Error reading previous results:\", error);\n    }\n    return {};\n}\n/**\n * Find block number at specific timestamp using Etherscan API\n */ async function getBlockNumberAtTimestamp(timestamp) {\n    try {\n        console.log(`Looking up block number for timestamp ${timestamp} using Etherscan API...`);\n        const response = await axios__WEBPACK_IMPORTED_MODULE_1__[\"default\"].get(ETHERSCAN_API_URL, {\n            params: {\n                module: \"block\",\n                action: \"getblocknobytime\",\n                timestamp,\n                closest: \"before\",\n                apikey: ETHERSCAN_API_KEY\n            }\n        });\n        if (response.data.status !== \"1\") {\n            throw new Error(`Etherscan API error: ${response.data.message}`);\n        }\n        const blockNumber = parseInt(response.data.result);\n        console.log(`Found block #${blockNumber} for timestamp ${timestamp}`);\n        return blockNumber;\n    } catch (error) {\n        console.error(\"Error getting block number:\", error);\n        throw error;\n    }\n}\n/**\n * Get BAYC total supply using multicall\n */ async function getTotalSupply(blockNumber) {\n    if (!multicallContract) {\n        multicallContract = initMulticall();\n    }\n    console.log(`Getting BAYC totalSupply at block ${blockNumber} using multicall...`);\n    const baycInterface = new ethers__WEBPACK_IMPORTED_MODULE_0__.ethers.utils.Interface(BAYC_ABI);\n    const callData = baycInterface.encodeFunctionData(\"totalSupply\", []);\n    const calls = [\n        {\n            target: BAYC_CONTRACT_ADDRESS,\n            callData\n        }\n    ];\n    const [, returnData] = await multicallContract.aggregate(calls, {\n        blockTag: blockNumber\n    });\n    const totalSupply = ethers__WEBPACK_IMPORTED_MODULE_0__.ethers.BigNumber.from(returnData[0]).toNumber();\n    console.log(`BAYC totalSupply: ${totalSupply}`);\n    return totalSupply;\n}\n/**\n * Get BAYC token owners using multicall in batches\n */ async function getTokenOwners(totalSupply, blockNumber) {\n    if (!multicallContract) {\n        multicallContract = initMulticall();\n    }\n    console.log(`Getting owners for all ${totalSupply} tokens using multicall in batches...`);\n    const baycInterface = new ethers__WEBPACK_IMPORTED_MODULE_0__.ethers.utils.Interface(BAYC_ABI);\n    const owners = new Set();\n    const batchSize = 50; // Process in batches of 50 tokens\n    for(let i = 1; i <= totalSupply; i += batchSize){\n        const end = Math.min(i + batchSize - 1, totalSupply);\n        console.log(`Processing tokens ${i} to ${end}...`);\n        // Create calls for this batch\n        const calls = [];\n        for(let tokenId = i; tokenId <= end; tokenId++){\n            calls.push({\n                target: BAYC_CONTRACT_ADDRESS,\n                allowFailure: true,\n                callData: baycInterface.encodeFunctionData(\"ownerOf\", [\n                    tokenId\n                ])\n            });\n        }\n        // Execute multicall\n        const results = await multicallContract.aggregate3(calls, {\n            blockTag: blockNumber\n        });\n        // Process results\n        for(let j = 0; j < results.length; j++){\n            const result = results[j];\n            if (result.success) {\n                try {\n                    const owner = baycInterface.decodeFunctionResult(\"ownerOf\", result.returnData)[0].toLowerCase();\n                    if (owner !== \"0x0000000000000000000000000000000000000000\") {\n                        owners.add(owner);\n                    }\n                } catch (error) {\n                    console.warn(`Failed to decode owner for token ${i + j}:`, error.message);\n                }\n            } else {\n                console.warn(`Token ${i + j} ownership check failed`);\n            }\n        }\n    }\n    const holderArray = Array.from(owners);\n    console.log(`Found ${holderArray.length} unique holders`);\n    return holderArray;\n}\n/**\n * Get ETH balances using multicall\n */ async function getEthBalancesMulticall(addresses, blockNumber) {\n    if (!multicallContract) {\n        multicallContract = initMulticall();\n    }\n    console.log(`Getting ETH balances for ${addresses.length} addresses with Multicall...`);\n    // Break addresses into chunks of 100 to avoid gas limit issues\n    const chunkSize = 100;\n    let totalBalance = ethers__WEBPACK_IMPORTED_MODULE_0__.ethers.BigNumber.from(0);\n    for(let i = 0; i < addresses.length; i += chunkSize){\n        const chunk = addresses.slice(i, i + chunkSize);\n        console.log(`Processing chunk ${Math.floor(i / chunkSize) + 1}/${Math.ceil(addresses.length / chunkSize)} (${chunk.length} addresses)`);\n        // Create calls array for multicall\n        const calls = chunk.map((address)=>({\n                target: MULTICALL_ADDRESS,\n                callData: multicallContract.interface.encodeFunctionData(\"getEthBalance\", [\n                    address\n                ])\n            }));\n        // Execute multicall\n        const [, returnData] = await multicallContract.aggregate(calls, {\n            blockTag: blockNumber\n        });\n        // Process results\n        for(let j = 0; j < returnData.length; j++){\n            try {\n                const balance = ethers__WEBPACK_IMPORTED_MODULE_0__.ethers.utils.defaultAbiCoder.decode([\n                    \"uint256\"\n                ], returnData[j])[0];\n                totalBalance = totalBalance.add(balance);\n            } catch (error) {\n                console.error(`Error decoding balance for address ${j + i}:`, error.message);\n            }\n        }\n    }\n    return totalBalance;\n}\n/**\n * Main function to get total ETH value of all BAYC holders\n */ async function getTotalEthValueOfHolders(timestamp) {\n    const startTime = Date.now();\n    try {\n        // Initialize provider and multicall contract\n        provider = initProvider();\n        multicallContract = initMulticall();\n        // Step 1: Get block number at timestamp\n        const blockNumber = await getBlockNumberAtTimestamp(timestamp);\n        // Step 2: Get total supply using multicall\n        const totalSupply = await getTotalSupply(blockNumber);\n        // Step 3: Get token owners using multicall\n        const holders = await getTokenOwners(totalSupply, blockNumber);\n        // Step 4: Get ETH balances using multicall\n        const totalWei = await getEthBalancesMulticall(holders, blockNumber);\n        const totalEth = ethers__WEBPACK_IMPORTED_MODULE_0__.ethers.utils.formatEther(totalWei);\n        const executionTime = Date.now() - startTime;\n        console.log(`Total ETH value: ${totalEth} ETH (execution time: ${executionTime}ms)`);\n        const result = {\n            totalEth,\n            totalWei,\n            holderCount: holders.length,\n            sampledHolders: holders.length,\n            executionTime,\n            block: blockNumber,\n            implementation: \"pure-multicall\"\n        };\n        // Save results for persistence\n        await saveResultsToFile(\"pure-multicall\", timestamp, result);\n        return result;\n    } catch (error) {\n        console.error(\"Error calculating total ETH value:\", error);\n        const executionTime = Date.now() - startTime;\n        return {\n            error: error.message,\n            blockNumber: 0,\n            holderCount: 0,\n            totalWei: ethers__WEBPACK_IMPORTED_MODULE_0__.ethers.BigNumber.from(0),\n            totalEth: \"0\",\n            executionTime,\n            implementation: \"pure-multicall-error\"\n        };\n    }\n}\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            message: \"Method not allowed\"\n        });\n    }\n    try {\n        const { timestamp, useCache } = req.body;\n        if (!timestamp) {\n            return res.status(400).json({\n                message: \"Timestamp is required\"\n            });\n        }\n        // Check if we have cached results\n        if (useCache !== false) {\n            const previousResults = getPreviousResults();\n            const cachedResult = previousResults?.[\"pure-multicall\"]?.[timestamp];\n            if (cachedResult) {\n                console.log(`Using cached result for timestamp ${timestamp}`);\n                // Convert string back to BigNumber for consistency\n                if (cachedResult.totalWei) {\n                    cachedResult.totalWei = ethers__WEBPACK_IMPORTED_MODULE_0__.ethers.BigNumber.from(cachedResult.totalWei);\n                }\n                return res.status(200).json({\n                    ...cachedResult,\n                    fromCache: true\n                });\n            }\n        }\n        const result = await getTotalEthValueOfHolders(timestamp);\n        return res.status(200).json(result);\n    } catch (error) {\n        console.error(\"Error in pure-multicall API handler:\", error);\n        return res.status(500).json({\n            message: \"Error processing request\",\n            error: error.message\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvaW1wbGVtZW50YXRpb25zL3B1cmUtbXVsdGljYWxsLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQUEscUVBQXFFO0FBQ3JDO0FBQ047QUFDTjtBQUNJO0FBRXhCLFlBQVk7QUFDWixNQUFNSSx3QkFBd0I7QUFDOUIsTUFBTUMsb0JBQW9CO0FBQzFCLE1BQU1DLG9CQUFvQkMsUUFBUUMsR0FBRyxDQUFDRixpQkFBaUIsSUFBSTtBQUMzRCxNQUFNRyxrQkFBa0JGLFFBQVFDLEdBQUcsQ0FBQ0MsZUFBZSxJQUFJO0FBQ3ZELE1BQU1DLGtCQUFrQixDQUFDLHFDQUFxQyxFQUFFRCxnQkFBZ0IsQ0FBQztBQUVqRiwrQkFBK0I7QUFDL0IsTUFBTUUsb0JBQW9CLDhDQUE4QyxzQkFBc0I7QUFFOUYscUJBQXFCO0FBQ3JCLE1BQU1DLGdCQUFnQjtJQUNwQjtJQUNBO0lBQ0E7Q0FDRDtBQUVELHdCQUF3QjtBQUN4QixNQUFNQyxXQUFXO0lBQ2Y7SUFDQTtDQUNEO0FBRUQsb0JBQW9CO0FBQ3BCLE1BQU1DLG9CQUFvQlgsZ0RBQVMsQ0FBQ0ksUUFBUVMsR0FBRyxJQUFJLFFBQVE7QUFFM0QsdUNBQXVDO0FBQ3ZDLElBQUlDLFdBQVc7QUFDZixJQUFJQyxvQkFBb0I7QUFFeEI7O0NBRUMsR0FDRCxNQUFNQyxlQUFlO0lBQ25CLElBQUlGLFVBQVUsT0FBT0E7SUFFckJHLFFBQVFDLEdBQUcsQ0FBQztJQUVaLElBQUlaLGlCQUFpQjtRQUNuQixJQUFJO1lBQ0ZXLFFBQVFDLEdBQUcsQ0FBQztZQUNaSixXQUFXLElBQUlqQiwwQ0FBTUEsQ0FBQ3NCLFNBQVMsQ0FBQ0MsZUFBZSxDQUFDYjtZQUNoRCxPQUFPTztRQUNULEVBQUUsT0FBT08sT0FBTztZQUNkSixRQUFRSSxLQUFLLENBQUMsOEJBQThCQSxNQUFNQyxPQUFPO1lBQ3pEUixXQUFXO1FBQ2I7SUFDRixPQUFPO1FBQ0xHLFFBQVFJLEtBQUssQ0FBQztJQUNoQjtJQUVBLE1BQU0s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QUFRLEdBQUc3QywwQ0FBTUEsQ0FBQzZFLFNBQVMsQ0FBQ0MsSUFBSSxDQUFDd0QsYUFBYXpGLFFBQVE7Z0JBQ3JFO2dCQUVBLE9BQU9tRixJQUFJbEUsTUFBTSxDQUFDLEtBQUtvRSxJQUFJLENBQUM7b0JBQzFCLEdBQUdJLFlBQVk7b0JBQ2ZDLFdBQVc7Z0JBQ2I7WUFDRjtRQUNGO1FBRUEsTUFBTXRHLFNBQVMsTUFBTW1GLDBCQUEwQnBGO1FBQy9DLE9BQU9nRyxJQUFJbEUsTUFBTSxDQUFDLEtBQUtvRSxJQUFJLENBQUNqRztJQUM5QixFQUFFLE9BQU9ULE9BQU87UUFDZEosUUFBUUksS0FBSyxDQUFDLHdDQUF3Q0E7UUFDdEQsT0FBT3dHLElBQUlsRSxNQUFNLENBQUMsS0FBS29FLElBQUksQ0FBQztZQUMxQnpHLFNBQVM7WUFDVEQsT0FBT0EsTUFBTUMsT0FBTztRQUN0QjtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iYXljLWV0aC1zdW0vLi9wYWdlcy9hcGkvaW1wbGVtZW50YXRpb25zL3B1cmUtbXVsdGljYWxsLmpzP2UxMjciXSwic291cmNlc0NvbnRlbnQiOlsiLy8gUHVyZS1NdWx0aWNhbGwgaW1wbGVtZW50YXRpb24gLSB1c2VzIG11bHRpY2FsbCBmb3IgQUxMIFJQQyBxdWVyaWVzXG5pbXBvcnQgeyBldGhlcnMgfSBmcm9tICdldGhlcnMnO1xuaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJztcbmltcG9ydCBmcyBmcm9tICdmcyc7XG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcblxuLy8gQ29uc3RhbnRzXG5jb25zdCBCQVlDX0NPTlRSQUNUX0FERFJFU1MgPSAnMHhCQzRDQTBFZEE3NjQ3QThhQjdDMjA2MWMyRTExOEExOGE5MzZmMTNEJztcbmNvbnN0IEVUSEVSU0NBTl9BUElfVVJMID0gJ2h0dHBzOi8vYXBpLmV0aGVyc2Nhbi5pby9hcGknO1xuY29uc3QgRVRIRVJTQ0FOX0FQSV9LRVkgPSBwcm9jZXNzLmVudi5FVEhFUlNDQU5fQVBJX0tFWSB8fCAnJztcbmNvbnN0IEFMQ0hFTVlfQVBJX0tFWSA9IHByb2Nlc3MuZW52LkFMQ0hFTVlfQVBJX0tFWSB8fCAnJztcbmNvbnN0IEFMQ0hFTVlfQVBJX1VSTCA9IGBodHRwczovL2V0aC1tYWlubmV0LmcuYWxjaGVteS5jb20vdjIvJHtBTENIRU1ZX0FQSV9LRVl9YDtcblxuLy8gTXVsdGljYWxsIENvbnRyYWN0IEFkZHJlc3Nlc1xuY29uc3QgTVVMVElDQUxMX0FERFJFU1MgPSAnMHhjQTExYmRlMDU5NzdiMzYzMTE2NzAyODg2MmJFMmExNzM5NzZDQTExJzsgLy8gTXVsdGljYWxsMyBjb250cmFjdFxuXG4vLyBBQkkgZm9yIE11bHRpY2FsbDNcbmNvbnN0IE1VTFRJQ0FMTF9BQkkgPSBbXG4gICdmdW5jdGlvbiBhZ2dyZWdhdGUodHVwbGUoYWRkcmVzcyB0YXJnZXQsIGJ5dGVzIGNhbGxEYXRhKVtdIGNhbGxzKSB2aWV3IHJldHVybnMgKHVpbnQyNTYgYmxvY2tOdW1iZXIsIGJ5dGVzW10gcmV0dXJuRGF0YSknLFxuICAnZnVuY3Rpb24gYWdncmVnYXRlMyh0dXBsZShhZGRyZXNzIHRhcmdldCwgYm9vbCBhbGxvd0ZhaWx1cmUsIGJ5dGVzIGNhbGxEYXRhKVtdIGNhbGxzKSB2aWV3IHJldHVybnMgKHR1cGxlKGJvb2wgc3VjY2VzcywgYnl0ZXMgcmV0dXJuRGF0YSlbXSByZXR1cm5EYXRhKScsXG4gICdmdW5jdGlvbiBnZXRFdGhCYWxhbmNlKGFkZHJlc3MgYWRkcikgdmlldyByZXR1cm5zICh1aW50MjU2IGJhbGFuY2UpJ1xuXTtcblxuLy8gQUJJIGZvciBFUkM3MjEgKEJBWUMpXG5jb25zdCBCQVlDX0FCSSA9IFtcbiAgJ2Z1bmN0aW9uIHRvdGFsU3VwcGx5KCkgdmlldyByZXR1cm5zICh1aW50MjU2KScsXG4gICdmdW5jdGlvbiBvd25lck9mKHVpbnQyNTYgdG9rZW5JZCkgdmlldyByZXR1cm5zIChhZGRyZXNzKSdcbl07XG5cbi8vIFJlc3VsdHMgZmlsZSBwYXRoXG5jb25zdCBSRVNVTFRTX0ZJTEVfUEFUSCA9IHBhdGguam9pbihwcm9jZXNzLmN3ZCgpLCAnZGF0YScsICdyZXN1bHRzLmpzb24nKTtcblxuLy8gUHJvdmlkZXIgYW5kIGNvbnRyYWN0IGluaXRpYWxpemF0aW9uXG5sZXQgcHJvdmlkZXIgPSBudWxsO1xubGV0IG11bHRpY2FsbENvbnRyYWN0ID0gbnVsbDtcblxuLyoqXG4gKiBJbml0aWFsaXplIHByb3ZpZGVyXG4gKi9cbmNvbnN0IGluaXRQcm92aWRlciA9ICgpID0+IHtcbiAgaWYgKHByb3ZpZGVyKSByZXR1cm4gcHJvdmlkZXI7XG4gIFxuICBjb25zb2xlLmxvZyhcIkluaXRpYWxpemluZyBwcm92aWRlci4uLlwiKTtcbiAgXG4gIGlmIChBTENIRU1ZX0FQSV9LRVkpIHtcbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coXCJVc2luZyBBbGNoZW15IHByb3ZpZGVyXCIpO1xuICAgICAgcHJvdmlkZXIgPSBuZXcgZXRoZXJzLnByb3ZpZGVycy5Kc29uUnBjUHJvdmlkZXIoQUxDSEVNWV9BUElfVVJMKTtcbiAgICAgIHJldHVybiBwcm92aWRlcjtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGNyZWF0ZSBwcm92aWRlcjonLCBlcnJvci5tZXNzYWdlKTtcbiAgICAgIHByb3ZpZGVyID0gbnVsbDtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgY29uc29sZS5lcnJvcihcIk5vIEFsY2hlbXkgQVBJIGtleSBwcm92aWRlZCFcIik7XG4gIH1cbiAgXG4gIHRocm93IG5ldyBFcnJvcihcIkZhaWxlZCB0byBpbml0aWFsaXplIHByb3ZpZGVyXCIpO1xufTtcblxuLyoqXG4gKiBJbml0aWFsaXplIE11bHRpY2FsbCBjb250cmFjdFxuICovXG5jb25zdCBpbml0TXVsdGljYWxsID0gKCkgPT4ge1xuICBpZiAobXVsdGljYWxsQ29udHJhY3QpIHJldHVybiBtdWx0aWNhbGxDb250cmFjdDtcbiAgXG4gIGNvbnN0IHAgPSBwcm92aWRlciB8fCBpbml0UHJvdmlkZXIoKTtcbiAgXG4gIHRyeSB7XG4gICAgbXVsdGljYWxsQ29udHJhY3QgPSBuZXcgZXRoZXJzLkNvbnRyYWN0KE1VTFRJQ0FMTF9BRERSRVNTLCBNVUxUSUNBTExfQUJJLCBwKTtcbiAgICBjb25zb2xlLmxvZyhcIk11bHRpY2FsbCBjb250cmFjdCBpbml0aWFsaXplZFwiKTtcbiAgICByZXR1cm4gbXVsdGljYWxsQ29udHJhY3Q7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkZhaWxlZCB0byBpbml0aWFsaXplIG11bHRpY2FsbCBjb250cmFjdDpcIiwgZXJyb3IubWVzc2FnZSk7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn07XG5cbi8qKlxuICogU2F2ZSByZXN1bHRzIHRvIGZpbGUgZm9yIHBlcnNpc3RlbmNlXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIHNhdmVSZXN1bHRzVG9GaWxlKGltcGxlbWVudGF0aW9uSWQsIHRpbWVzdGFtcCwgcmVzdWx0KSB7XG4gIHRyeSB7XG4gICAgLy8gQ3JlYXRlIGRpcmVjdG9yeSBpZiBpdCBkb2Vzbid0IGV4aXN0XG4gICAgY29uc3QgZGlyID0gcGF0aC5kaXJuYW1lKFJFU1VMVFNfRklMRV9QQVRIKTtcbiAgICBpZiAoIWZzLmV4aXN0c1N5bmMoZGlyKSkge1xuICAgICAgZnMubWtkaXJTeW5jKGRpciwgeyByZWN1cnNpdmU6IHRydWUgfSk7XG4gICAgfVxuICAgIFxuICAgIC8vIFJlYWQgZXhpc3RpbmcgcmVzdWx0cyBvciBjcmVhdGUgbmV3IG9iamVjdFxuICAgIGxldCByZXN1bHRzID0ge307XG4gICAgaWYgKGZzLmV4aXN0c1N5bmMoUkVTVUxUU19GSUxFX1BBVEgpKSB7XG4gICAgICBjb25zdCBmaWxlQ29udGVudCA9IGZzLnJlYWRGaWxlU3luYyhSRVNVTFRTX0ZJTEVfUEFUSCwgJ3V0ZjgnKTtcbiAgICAgIHJlc3VsdHMgPSBKU09OLnBhcnNlKGZpbGVDb250ZW50KTtcbiAgICB9XG4gICAgXG4gICAgLy8gQWRkIG5ldyByZXN1bHRcbiAgICBpZiAoIXJlc3VsdHNbaW1wbGVtZW50YXRpb25JZF0pIHtcbiAgICAgIHJlc3VsdHNbaW1wbGVtZW50YXRpb25JZF0gPSB7fTtcbiAgICB9XG4gICAgXG4gICAgLy8gQ29udmVydCBCaWdOdW1iZXIgdG8gc3RyaW5nIGZvciBKU09OIHN0b3JhZ2VcbiAgICBjb25zdCByZXN1bHRUb1NhdmUgPSB7XG4gICAgICAuLi5yZXN1bHQsXG4gICAgICB0b3RhbFdlaTogcmVzdWx0LnRvdGFsV2VpPy50b1N0cmluZygpLFxuICAgICAgZXhlY3V0aW9uVGltZTogcmVzdWx0LmV4ZWN1dGlvblRpbWUsXG4gICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxuICAgIH07XG4gICAgXG4gICAgcmVzdWx0c1tpbXBsZW1lbnRhdGlvbklkXVt0aW1lc3RhbXBdID0gcmVzdWx0VG9TYXZlO1xuICAgIFxuICAgIC8vIFdyaXRlIGJhY2sgdG8gZmlsZVxuICAgIGZzLndyaXRlRmlsZVN5bmMoUkVTVUxUU19GSUxFX1BBVEgsIEpTT04uc3RyaW5naWZ5KHJlc3VsdHMsIG51bGwsIDIpKTtcbiAgICBjb25zb2xlLmxvZyhgUmVzdWx0cyBzYXZlZCB0byAke1JFU1VMVFNfRklMRV9QQVRIfWApO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNhdmluZyByZXN1bHRzIHRvIGZpbGU6JywgZXJyb3IpO1xuICB9XG59XG5cbi8qKlxuICogR2V0IHByZXZpb3VzIHJlc3VsdHMgZnJvbSBjYWNoZSBmaWxlXG4gKi9cbmZ1bmN0aW9uIGdldFByZXZpb3VzUmVzdWx0cygpIHtcbiAgdHJ5IHtcbiAgICBpZiAoZnMuZXhpc3RzU3luYyhSRVNVTFRTX0ZJTEVfUEFUSCkpIHtcbiAgICAgIGNvbnN0IGZpbGVDb250ZW50ID0gZnMucmVhZEZpbGVTeW5jKFJFU1VMVFNfRklMRV9QQVRILCAndXRmOCcpO1xuICAgICAgcmV0dXJuIEpTT04ucGFyc2UoZmlsZUNvbnRlbnQpO1xuICAgIH1cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWFkaW5nIHByZXZpb3VzIHJlc3VsdHM6JywgZXJyb3IpO1xuICB9XG4gIHJldHVybiB7fTtcbn1cblxuLyoqXG4gKiBGaW5kIGJsb2NrIG51bWJlciBhdCBzcGVjaWZpYyB0aW1lc3RhbXAgdXNpbmcgRXRoZXJzY2FuIEFQSVxuICovXG5hc3luYyBmdW5jdGlvbiBnZXRCbG9ja051bWJlckF0VGltZXN0YW1wKHRpbWVzdGFtcCkge1xuICB0cnkge1xuICAgIGNvbnNvbGUubG9nKGBMb29raW5nIHVwIGJsb2NrIG51bWJlciBmb3IgdGltZXN0YW1wICR7dGltZXN0YW1wfSB1c2luZyBFdGhlcnNjYW4gQVBJLi4uYCk7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBheGlvcy5nZXQoRVRIRVJTQ0FOX0FQSV9VUkwsIHtcbiAgICAgIHBhcmFtczoge1xuICAgICAgICBtb2R1bGU6ICdibG9jaycsXG4gICAgICAgIGFjdGlvbjogJ2dldGJsb2Nrbm9ieXRpbWUnLFxuICAgICAgICB0aW1lc3RhbXAsXG4gICAgICAgIGNsb3Nlc3Q6ICdiZWZvcmUnLFxuICAgICAgICBhcGlrZXk6IEVUSEVSU0NBTl9BUElfS0VZXG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBpZiAocmVzcG9uc2UuZGF0YS5zdGF0dXMgIT09ICcxJykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBFdGhlcnNjYW4gQVBJIGVycm9yOiAke3Jlc3BvbnNlLmRhdGEubWVzc2FnZX1gKTtcbiAgICB9XG5cbiAgICBjb25zdCBibG9ja051bWJlciA9IHBhcnNlSW50KHJlc3BvbnNlLmRhdGEucmVzdWx0KTtcbiAgICBjb25zb2xlLmxvZyhgRm91bmQgYmxvY2sgIyR7YmxvY2tOdW1iZXJ9IGZvciB0aW1lc3RhbXAgJHt0aW1lc3RhbXB9YCk7XG4gICAgcmV0dXJuIGJsb2NrTnVtYmVyO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGdldHRpbmcgYmxvY2sgbnVtYmVyOicsIGVycm9yKTtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG4vKipcbiAqIEdldCBCQVlDIHRvdGFsIHN1cHBseSB1c2luZyBtdWx0aWNhbGxcbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0VG90YWxTdXBwbHkoYmxvY2tOdW1iZXIpIHtcbiAgaWYgKCFtdWx0aWNhbGxDb250cmFjdCkge1xuICAgIG11bHRpY2FsbENvbnRyYWN0ID0gaW5pdE11bHRpY2FsbCgpO1xuICB9XG4gIFxuICBjb25zb2xlLmxvZyhgR2V0dGluZyBCQVlDIHRvdGFsU3VwcGx5IGF0IGJsb2NrICR7YmxvY2tOdW1iZXJ9IHVzaW5nIG11bHRpY2FsbC4uLmApO1xuICBcbiAgY29uc3QgYmF5Y0ludGVyZmFjZSA9IG5ldyBldGhlcnMudXRpbHMuSW50ZXJmYWNlKEJBWUNfQUJJKTtcbiAgY29uc3QgY2FsbERhdGEgPSBiYXljSW50ZXJmYWNlLmVuY29kZUZ1bmN0aW9uRGF0YSgndG90YWxTdXBwbHknLCBbXSk7XG4gIFxuICBjb25zdCBjYWxscyA9IFt7XG4gICAgdGFyZ2V0OiBCQVlDX0NPTlRSQUNUX0FERFJFU1MsXG4gICAgY2FsbERhdGFcbiAgfV07XG4gIFxuICBjb25zdCBbLCByZXR1cm5EYXRhXSA9IGF3YWl0IG11bHRpY2FsbENvbnRyYWN0LmFnZ3JlZ2F0ZShjYWxscywgeyBibG9ja1RhZzogYmxvY2tOdW1iZXIgfSk7XG4gIGNvbnN0IHRvdGFsU3VwcGx5ID0gZXRoZXJzLkJpZ051bWJlci5mcm9tKHJldHVybkRhdGFbMF0pLnRvTnVtYmVyKCk7XG4gIFxuICBjb25zb2xlLmxvZyhgQkFZQyB0b3RhbFN1cHBseTogJHt0b3RhbFN1cHBseX1gKTtcbiAgcmV0dXJuIHRvdGFsU3VwcGx5O1xufVxuXG4vKipcbiAqIEdldCBCQVlDIHRva2VuIG93bmVycyB1c2luZyBtdWx0aWNhbGwgaW4gYmF0Y2hlc1xuICovXG5hc3luYyBmdW5jdGlvbiBnZXRUb2tlbk93bmVycyh0b3RhbFN1cHBseSwgYmxvY2tOdW1iZXIpIHtcbiAgaWYgKCFtdWx0aWNhbGxDb250cmFjdCkge1xuICAgIG11bHRpY2FsbENvbnRyYWN0ID0gaW5pdE11bHRpY2FsbCgpO1xuICB9XG4gIFxuICBjb25zb2xlLmxvZyhgR2V0dGluZyBvd25lcnMgZm9yIGFsbCAke3RvdGFsU3VwcGx5fSB0b2tlbnMgdXNpbmcgbXVsdGljYWxsIGluIGJhdGNoZXMuLi5gKTtcbiAgXG4gIGNvbnN0IGJheWNJbnRlcmZhY2UgPSBuZXcgZXRoZXJzLnV0aWxzLkludGVyZmFjZShCQVlDX0FCSSk7XG4gIGNvbnN0IG93bmVycyA9IG5ldyBTZXQoKTtcbiAgY29uc3QgYmF0Y2hTaXplID0gNTA7IC8vIFByb2Nlc3MgaW4gYmF0Y2hlcyBvZiA1MCB0b2tlbnNcbiAgXG4gIGZvciAobGV0IGkgPSAxOyBpIDw9IHRvdGFsU3VwcGx5OyBpICs9IGJhdGNoU2l6ZSkge1xuICAgIGNvbnN0IGVuZCA9IE1hdGgubWluKGkgKyBiYXRjaFNpemUgLSAxLCB0b3RhbFN1cHBseSk7XG4gICAgY29uc29sZS5sb2coYFByb2Nlc3NpbmcgdG9rZW5zICR7aX0gdG8gJHtlbmR9Li4uYCk7XG4gICAgXG4gICAgLy8gQ3JlYXRlIGNhbGxzIGZvciB0aGlzIGJhdGNoXG4gICAgY29uc3QgY2FsbHMgPSBbXTtcbiAgICBmb3IgKGxldCB0b2tlbklkID0gaTsgdG9rZW5JZCA8PSBlbmQ7IHRva2VuSWQrKykge1xuICAgICAgY2FsbHMucHVzaCh7XG4gICAgICAgIHRhcmdldDogQkFZQ19DT05UUkFDVF9BRERSRVNTLFxuICAgICAgICBhbGxvd0ZhaWx1cmU6IHRydWUsXG4gICAgICAgIGNhbGxEYXRhOiBiYXljSW50ZXJmYWNlLmVuY29kZUZ1bmN0aW9uRGF0YSgnb3duZXJPZicsIFt0b2tlbklkXSlcbiAgICAgIH0pO1xuICAgIH1cbiAgICBcbiAgICAvLyBFeGVjdXRlIG11bHRpY2FsbFxuICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBtdWx0aWNhbGxDb250cmFjdC5hZ2dyZWdhdGUzKGNhbGxzLCB7IGJsb2NrVGFnOiBibG9ja051bWJlciB9KTtcbiAgICBcbiAgICAvLyBQcm9jZXNzIHJlc3VsdHNcbiAgICBmb3IgKGxldCBqID0gMDsgaiA8IHJlc3VsdHMubGVuZ3RoOyBqKyspIHtcbiAgICAgIGNvbnN0IHJlc3VsdCA9IHJlc3VsdHNbal07XG4gICAgICBpZiAocmVzdWx0LnN1Y2Nlc3MpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBvd25lciA9IGJheWNJbnRlcmZhY2UuZGVjb2RlRnVuY3Rpb25SZXN1bHQoJ293bmVyT2YnLCByZXN1bHQucmV0dXJuRGF0YSlbMF0udG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICBpZiAob3duZXIgIT09ICcweDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAnKSB7XG4gICAgICAgICAgICBvd25lcnMuYWRkKG93bmVyKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKGBGYWlsZWQgdG8gZGVjb2RlIG93bmVyIGZvciB0b2tlbiAke2kgKyBqfTpgLCBlcnJvci5tZXNzYWdlKTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS53YXJuKGBUb2tlbiAke2kgKyBqfSBvd25lcnNoaXAgY2hlY2sgZmFpbGVkYCk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIFxuICBjb25zdCBob2xkZXJBcnJheSA9IEFycmF5LmZyb20ob3duZXJzKTtcbiAgY29uc29sZS5sb2coYEZvdW5kICR7aG9sZGVyQXJyYXkubGVuZ3RofSB1bmlxdWUgaG9sZGVyc2ApO1xuICByZXR1cm4gaG9sZGVyQXJyYXk7XG59XG5cbi8qKlxuICogR2V0IEVUSCBiYWxhbmNlcyB1c2luZyBtdWx0aWNhbGxcbiAqL1xuYXN5bmMgZnVuY3Rpb24gZ2V0RXRoQmFsYW5jZXNNdWx0aWNhbGwoYWRkcmVzc2VzLCBibG9ja051bWJlcikge1xuICBpZiAoIW11bHRpY2FsbENvbnRyYWN0KSB7XG4gICAgbXVsdGljYWxsQ29udHJhY3QgPSBpbml0TXVsdGljYWxsKCk7XG4gIH1cbiAgXG4gIGNvbnNvbGUubG9nKGBHZXR0aW5nIEVUSCBiYWxhbmNlcyBmb3IgJHthZGRyZXNzZXMubGVuZ3RofSBhZGRyZXNzZXMgd2l0aCBNdWx0aWNhbGwuLi5gKTtcbiAgXG4gIC8vIEJyZWFrIGFkZHJlc3NlcyBpbnRvIGNodW5rcyBvZiAxMDAgdG8gYXZvaWQgZ2FzIGxpbWl0IGlzc3Vlc1xuICBjb25zdCBjaHVua1NpemUgPSAxMDA7XG4gIGxldCB0b3RhbEJhbGFuY2UgPSBldGhlcnMuQmlnTnVtYmVyLmZyb20oMCk7XG4gIFxuICBmb3IgKGxldCBpID0gMDsgaSA8IGFkZHJlc3Nlcy5sZW5ndGg7IGkgKz0gY2h1bmtTaXplKSB7XG4gICAgY29uc3QgY2h1bmsgPSBhZGRyZXNzZXMuc2xpY2UoaSwgaSArIGNodW5rU2l6ZSk7XG4gICAgY29uc29sZS5sb2coYFByb2Nlc3NpbmcgY2h1bmsgJHtNYXRoLmZsb29yKGkvY2h1bmtTaXplKSArIDF9LyR7TWF0aC5jZWlsKGFkZHJlc3Nlcy5sZW5ndGgvY2h1bmtTaXplKX0gKCR7Y2h1bmsubGVuZ3RofSBhZGRyZXNzZXMpYCk7XG4gICAgXG4gICAgLy8gQ3JlYXRlIGNhbGxzIGFycmF5IGZvciBtdWx0aWNhbGxcbiAgICBjb25zdCBjYWxscyA9IGNodW5rLm1hcChhZGRyZXNzID0+ICh7XG4gICAgICB0YXJnZXQ6IE1VTFRJQ0FMTF9BRERSRVNTLFxuICAgICAgY2FsbERhdGE6IG11bHRpY2FsbENvbnRyYWN0LmludGVyZmFjZS5lbmNvZGVGdW5jdGlvbkRhdGEoJ2dldEV0aEJhbGFuY2UnLCBbYWRkcmVzc10pXG4gICAgfSkpO1xuICAgIFxuICAgIC8vIEV4ZWN1dGUgbXVsdGljYWxsXG4gICAgY29uc3QgWywgcmV0dXJuRGF0YV0gPSBhd2FpdCBtdWx0aWNhbGxDb250cmFjdC5hZ2dyZWdhdGUoY2FsbHMsIHsgYmxvY2tUYWc6IGJsb2NrTnVtYmVyIH0pO1xuICAgIFxuICAgIC8vIFByb2Nlc3MgcmVzdWx0c1xuICAgIGZvciAobGV0IGogPSAwOyBqIDwgcmV0dXJuRGF0YS5sZW5ndGg7IGorKykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgYmFsYW5jZSA9IGV0aGVycy51dGlscy5kZWZhdWx0QWJpQ29kZXIuZGVjb2RlKFsndWludDI1NiddLCByZXR1cm5EYXRhW2pdKVswXTtcbiAgICAgICAgdG90YWxCYWxhbmNlID0gdG90YWxCYWxhbmNlLmFkZChiYWxhbmNlKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGRlY29kaW5nIGJhbGFuY2UgZm9yIGFkZHJlc3MgJHtqICsgaX06YCwgZXJyb3IubWVzc2FnZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIFxuICByZXR1cm4gdG90YWxCYWxhbmNlO1xufVxuXG4vKipcbiAqIE1haW4gZnVuY3Rpb24gdG8gZ2V0IHRvdGFsIEVUSCB2YWx1ZSBvZiBhbGwgQkFZQyBob2xkZXJzXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGdldFRvdGFsRXRoVmFsdWVPZkhvbGRlcnModGltZXN0YW1wKSB7XG4gIGNvbnN0IHN0YXJ0VGltZSA9IERhdGUubm93KCk7XG4gIFxuICB0cnkge1xuICAgIC8vIEluaXRpYWxpemUgcHJvdmlkZXIgYW5kIG11bHRpY2FsbCBjb250cmFjdFxuICAgIHByb3ZpZGVyID0gaW5pdFByb3ZpZGVyKCk7XG4gICAgbXVsdGljYWxsQ29udHJhY3QgPSBpbml0TXVsdGljYWxsKCk7XG4gICAgXG4gICAgLy8gU3RlcCAxOiBHZXQgYmxvY2sgbnVtYmVyIGF0IHRpbWVzdGFtcFxuICAgIGNvbnN0IGJsb2NrTnVtYmVyID0gYXdhaXQgZ2V0QmxvY2tOdW1iZXJBdFRpbWVzdGFtcCh0aW1lc3RhbXApO1xuICAgIFxuICAgIC8vIFN0ZXAgMjogR2V0IHRvdGFsIHN1cHBseSB1c2luZyBtdWx0aWNhbGxcbiAgICBjb25zdCB0b3RhbFN1cHBseSA9IGF3YWl0IGdldFRvdGFsU3VwcGx5KGJsb2NrTnVtYmVyKTtcbiAgICBcbiAgICAvLyBTdGVwIDM6IEdldCB0b2tlbiBvd25lcnMgdXNpbmcgbXVsdGljYWxsXG4gICAgY29uc3QgaG9sZGVycyA9IGF3YWl0IGdldFRva2VuT3duZXJzKHRvdGFsU3VwcGx5LCBibG9ja051bWJlcik7XG4gICAgXG4gICAgLy8gU3RlcCA0OiBHZXQgRVRIIGJhbGFuY2VzIHVzaW5nIG11bHRpY2FsbFxuICAgIGNvbnN0IHRvdGFsV2VpID0gYXdhaXQgZ2V0RXRoQmFsYW5jZXNNdWx0aWNhbGwoaG9sZGVycywgYmxvY2tOdW1iZXIpO1xuICAgIGNvbnN0IHRvdGFsRXRoID0gZXRoZXJzLnV0aWxzLmZvcm1hdEV0aGVyKHRvdGFsV2VpKTtcbiAgICBcbiAgICBjb25zdCBleGVjdXRpb25UaW1lID0gRGF0ZS5ub3coKSAtIHN0YXJ0VGltZTtcbiAgICBjb25zb2xlLmxvZyhgVG90YWwgRVRIIHZhbHVlOiAke3RvdGFsRXRofSBFVEggKGV4ZWN1dGlvbiB0aW1lOiAke2V4ZWN1dGlvblRpbWV9bXMpYCk7XG4gICAgXG4gICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgdG90YWxFdGgsXG4gICAgICB0b3RhbFdlaSxcbiAgICAgIGhvbGRlckNvdW50OiBob2xkZXJzLmxlbmd0aCxcbiAgICAgIHNhbXBsZWRIb2xkZXJzOiBob2xkZXJzLmxlbmd0aCxcbiAgICAgIGV4ZWN1dGlvblRpbWUsXG4gICAgICBibG9jazogYmxvY2tOdW1iZXIsXG4gICAgICBpbXBsZW1lbnRhdGlvbjogJ3B1cmUtbXVsdGljYWxsJ1xuICAgIH07XG4gICAgXG4gICAgLy8gU2F2ZSByZXN1bHRzIGZvciBwZXJzaXN0ZW5jZVxuICAgIGF3YWl0IHNhdmVSZXN1bHRzVG9GaWxlKCdwdXJlLW11bHRpY2FsbCcsIHRpbWVzdGFtcCwgcmVzdWx0KTtcbiAgICBcbiAgICByZXR1cm4gcmVzdWx0O1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbGN1bGF0aW5nIHRvdGFsIEVUSCB2YWx1ZTonLCBlcnJvcik7XG4gICAgY29uc3QgZXhlY3V0aW9uVGltZSA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlLFxuICAgICAgYmxvY2tOdW1iZXI6IDAsXG4gICAgICBob2xkZXJDb3VudDogMCxcbiAgICAgIHRvdGFsV2VpOiBldGhlcnMuQmlnTnVtYmVyLmZyb20oMCksXG4gICAgICB0b3RhbEV0aDogXCIwXCIsXG4gICAgICBleGVjdXRpb25UaW1lLFxuICAgICAgaW1wbGVtZW50YXRpb246IFwicHVyZS1tdWx0aWNhbGwtZXJyb3JcIlxuICAgIH07XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgYXN5bmMgZnVuY3Rpb24gaGFuZGxlcihyZXEsIHJlcykge1xuICBpZiAocmVxLm1ldGhvZCAhPT0gJ1BPU1QnKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgbWVzc2FnZTogJ01ldGhvZCBub3QgYWxsb3dlZCcgfSk7XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IHsgdGltZXN0YW1wLCB1c2VDYWNoZSB9ID0gcmVxLmJvZHk7XG4gICAgXG4gICAgaWYgKCF0aW1lc3RhbXApIHtcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IG1lc3NhZ2U6ICdUaW1lc3RhbXAgaXMgcmVxdWlyZWQnIH0pO1xuICAgIH1cblxuICAgIC8vIENoZWNrIGlmIHdlIGhhdmUgY2FjaGVkIHJlc3VsdHNcbiAgICBpZiAodXNlQ2FjaGUgIT09IGZhbHNlKSB7XG4gICAgICBjb25zdCBwcmV2aW91c1Jlc3VsdHMgPSBnZXRQcmV2aW91c1Jlc3VsdHMoKTtcbiAgICAgIGNvbnN0IGNhY2hlZFJlc3VsdCA9IHByZXZpb3VzUmVzdWx0cz8uWydwdXJlLW11bHRpY2FsbCddPy5bdGltZXN0YW1wXTtcbiAgICAgIFxuICAgICAgaWYgKGNhY2hlZFJlc3VsdCkge1xuICAgICAgICBjb25zb2xlLmxvZyhgVXNpbmcgY2FjaGVkIHJlc3VsdCBmb3IgdGltZXN0YW1wICR7dGltZXN0YW1wfWApO1xuICAgICAgICBcbiAgICAgICAgLy8gQ29udmVydCBzdHJpbmcgYmFjayB0byBCaWdOdW1iZXIgZm9yIGNvbnNpc3RlbmN5XG4gICAgICAgIGlmIChjYWNoZWRSZXN1bHQudG90YWxXZWkpIHtcbiAgICAgICAgICBjYWNoZWRSZXN1bHQudG90YWxXZWkgPSBldGhlcnMuQmlnTnVtYmVyLmZyb20oY2FjaGVkUmVzdWx0LnRvdGFsV2VpKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgICAgICAuLi5jYWNoZWRSZXN1bHQsXG4gICAgICAgICAgZnJvbUNhY2hlOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFRvdGFsRXRoVmFsdWVPZkhvbGRlcnModGltZXN0YW1wKTtcbiAgICByZXR1cm4gcmVzLnN0YXR1cygyMDApLmpzb24ocmVzdWx0KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBpbiBwdXJlLW11bHRpY2FsbCBBUEkgaGFuZGxlcjonLCBlcnJvcik7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgXG4gICAgICBtZXNzYWdlOiAnRXJyb3IgcHJvY2Vzc2luZyByZXF1ZXN0JywgXG4gICAgICBlcnJvcjogZXJyb3IubWVzc2FnZSBcbiAgICB9KTtcbiAgfVxufSAiXSwibmFtZXMiOlsiZXRoZXJzIiwiYXhpb3MiLCJmcyIsInBhdGgiLCJCQVlDX0NPTlRSQUNUX0FERFJFU1MiLCJFVEhFUlNDQU5fQVBJX1VSTCIsIkVUSEVSU0NBTl9BUElfS0VZIiwicHJvY2VzcyIsImVudiIsIkFMQ0hFTVlfQVBJX0tFWSIsIkFMQ0hFTVlfQVBJX1VSTCIsIk1VTFRJQ0FMTF9BRERSRVNTIiwiTVVMVElDQUxMX0FCSSIsIkJBWUNfQUJJIiwiUkVTVUxUU19GSUxFX1BBVEgiLCJqb2luIiwiY3dkIiwicHJvdmlkZXIiLCJtdWx0aWNhbGxDb250cmFjdCIsImluaXRQcm92aWRlciIsImNvbnNvbGUiLCJsb2ciLCJwcm92aWRlcnMiLCJKc29uUnBjUHJvdmlkZXIiLCJlcnJvciIsIm1lc3NhZ2UiLCJFcnJvciIsImluaXRNdWx0aWNhbGwiLCJwIiwiQ29udHJhY3QiLCJzYXZlUmVzdWx0c1RvRmlsZSIsImltcGxlbWVudGF0aW9uSWQiLCJ0aW1lc3RhbXAiLCJyZXN1bHQiLCJkaXIiLCJkaXJuYW1lIiwiZXhpc3RzU3luYyIsIm1rZGlyU3luYyIsInJlY3Vyc2l2ZSIsInJlc3VsdHMiLCJmaWxlQ29udGVudCIsInJlYWRGaWxlU3luYyIsIkpTT04iLCJwYXJzZSIsInJlc3VsdFRvU2F2ZSIsInRvdGFsV2VpIiwidG9TdHJpbmciLCJleGVjdXRpb25UaW1lIiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwid3JpdGVGaWxlU3luYyIsInN0cmluZ2lmeSIsImdldFByZXZpb3VzUmVzdWx0cyIsImdldEJsb2NrTnVtYmVyQXRUaW1lc3RhbXAiLCJyZXNwb25zZSIsImdldCIsInBhcmFtcyIsIm1vZHVsZSIsImFjdGlvbiIsImNsb3Nlc3QiLCJhcGlrZXkiLCJkYXRhIiwic3RhdHVzIiwiYmxvY2tOdW1iZXIiLCJwYXJzZUludCIsImdldFRvdGFsU3VwcGx5IiwiYmF5Y0ludGVyZmFjZSIsInV0aWxzIiwiSW50ZXJmYWNlIiwiY2FsbERhdGEiLCJlbmNvZGVGdW5jdGlvbkRhdGEiLCJjYWxscyIsInRhcmdldCIsInJldHVybkRhdGEiLCJhZ2dyZWdhdGUiLCJibG9ja1RhZyIsInRvdGFsU3VwcGx5IiwiQmlnTnVtYmVyIiwiZnJvbSIsInRvTnVtYmVyIiwiZ2V0VG9rZW5Pd25lcnMiLCJvd25lcnMiLCJTZXQiLCJiYXRjaFNpemUiLCJpIiwiZW5kIiwiTWF0aCIsIm1pbiIsInRva2VuSWQiLCJwdXNoIiwiYWxsb3dGYWlsdXJlIiwiYWdncmVnYXRlMyIsImoiLCJsZW5ndGgiLCJzdWNjZXNzIiwib3duZXIiLCJkZWNvZGVGdW5jdGlvblJlc3VsdCIsInRvTG93ZXJDYXNlIiwiYWRkIiwid2FybiIsImhvbGRlckFycmF5IiwiQXJyYXkiLCJnZXRFdGhCYWxhbmNlc011bHRpY2FsbCIsImFkZHJlc3NlcyIsImNodW5rU2l6ZSIsInRvdGFsQmFsYW5jZSIsImNodW5rIiwic2xpY2UiLCJmbG9vciIsImNlaWwiLCJtYXAiLCJhZGRyZXNzIiwiaW50ZXJmYWNlIiwiYmFsYW5jZSIsImRlZmF1bHRBYmlDb2RlciIsImRlY29kZSIsImdldFRvdGFsRXRoVmFsdWVPZkhvbGRlcnMiLCJzdGFydFRpbWUiLCJub3ciLCJob2xkZXJzIiwidG90YWxFdGgiLCJmb3JtYXRFdGhlciIsImhvbGRlckNvdW50Iiwic2FtcGxlZEhvbGRlcnMiLCJibG9jayIsImltcGxlbWVudGF0aW9uIiwiaGFuZGxlciIsInJlcSIsInJlcyIsIm1ldGhvZCIsImpzb24iLCJ1c2VDYWNoZSIsImJvZHkiLCJwcmV2aW91c1Jlc3VsdHMiLCJjYWNoZWRSZXN1bHQiLCJmcm9tQ2FjaGUiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/implementations/pure-multicall.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fimplementations%2Fpure-multicall&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fimplementations%2Fpure-multicall.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();